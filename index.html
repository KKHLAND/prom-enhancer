<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI 프롬프트 개선기</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Noto Sans KR', arial;
      }
      /* For a custom scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: #d1fae5; /* bg-emerald-100 */
      }
      ::-webkit-scrollbar-thumb {
        background: #6ee7b7; /* bg-emerald-300 */
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #34d399; /* bg-emerald-400 */
      }
    </style>
  </head>
  <body class="bg-emerald-50 text-slate-900 antialiased">
    <div id="root"></div>
    <script type="module">
      import React, { useState, useCallback } from 'https://esm.sh/react@19.1.0';
      import ReactDOM from 'https://esm.sh/react-dom@19.1.0/client';
      import { GoogleGenerativeAI, HarmCategory, HarmBlockThreshold } from "https://esm.sh/@google/generative-ai@0.15.0";

      // --- Start of ClipboardIcon.tsx ---
      const ClipboardIcon = (props) => (
        React.createElement('svg', {
          xmlns: "http://www.w3.org/2000/svg",
          width: "24",
          height: "24",
          viewBox: "0 0 24 24",
          fill: "none",
          stroke: "currentColor",
          strokeWidth: "2",
          strokeLinecap: "round",
          strokeLinejoin: "round",
          ...props
        },
        React.createElement('rect', { width: "8", height: "4", x: "8", y: "2", rx: "1", ry: "1" }),
        React.createElement('path', { d: "M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2" })
        )
      );
      // --- End of ClipboardIcon.tsx ---

      // --- Start of SparklesIcon.tsx ---
      const SparklesIcon = (props) => (
        React.createElement('svg', {
          xmlns: "http://www.w3.org/2000/svg",
          width: "24",
          height: "24",
          viewBox: "0 0 24 24",
          fill: "none",
          stroke: "currentColor",
          strokeWidth: "2",
          strokeLinecap: "round",
          strokeLinejoin: "round",
          ...props
        },
        React.createElement('path', { d: "M9.937 15.5L12 21l2.063-5.5L19.5 13.5 14.063 12 12 6.5 9.937 12 4.5 13.5l5.437 1.5zM21 3l-1.5 1.5M3 21l1.5-1.5" })
        )
      );
      // --- End of SparklesIcon.tsx ---

      // --- Start of CheckIcon.tsx ---
      const CheckIcon = (props) => (
        React.createElement('svg', {
          xmlns: "http://www.w3.org/2000/svg",
          width: "24",
          height: "24",
          viewBox: "0 0 24 24",
          fill: "none",
          stroke: "currentColor",
          strokeWidth: "2",
          strokeLinecap: "round",
          strokeLinejoin: "round",
          ...props
        },
        React.createElement('path', { d: "M20 6 9 17l-5-5" })
        )
      );
      // --- End of CheckIcon.tsx ---

      // --- Start of QuestionMarkCircleIcon.tsx ---
      const QuestionMarkCircleIcon = (props) => (
        React.createElement('svg', {
          xmlns: "http://www.w3.org/2000/svg",
          fill: "none",
          viewBox: "0 0 24 24",
          strokeWidth: 1.5,
          stroke: "currentColor",
          ...props
        },
        React.createElement('path', {
          strokeLinecap: "round",
          strokeLinejoin: "round",
          d: "M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 5.25h.008v.008H12v-.008Z"
        })
        )
      );
      // --- End of QuestionMarkCircleIcon.tsx ---
      
      // --- Start of geminiService.ts ---
      const API_KEY = "AIzaSyCxxYfU2PeJ6OHqs-N0CNKrB9R3sN_5wqs"; // <<<<<<<<<<<<<<< 중요: 여기에 당신의 Gemini API 키를 입력하세요.
      
      const genAI = new GoogleGenerativeAI(API_KEY);

      const enhancePrompt = async (originalPrompt) => {
        if (API_KEY === "PLACEHOLDER_API_KEY") {
            throw new Error("Gemini API 키를 입력해주세요. 코드 상단의 API_KEY 변수를 수정하세요.");
        }
        try {
            const systemInstruction = `당신은 컨텍스트 엔지니어링 기법을 전문으로 하는 세계 최고 수준의 프롬프트 엔지니어입니다.
            당신의 임무는 사용자의 초기 프롬프트를 받아 3가지 독특하고 창의적인 구조화된 프롬프트 변형으로 개선하는 것입니다.
            각 변형은 다음 구조를 따라야 합니다: 미션, 페르소나, 청중, 목표, 톤앤매너, 절차, 제약 조건, 출력 형식.
            이러한 구조화된 구성 요소를 사용하여 원래 아이디어를 훨씬 더 상세하고, 맥락에 맞으며, 모든 LLM에 효과적인 프롬프트로 변환하는 데 집중하세요.

            - **미션 (Mission):** AI의 전반적인 임무를 정의합니다.
            - **페르소나 (Persona):** AI가 채택해야 할 역할이나 캐릭터를 지정합니다. 적절하지 않은 경우 '해당 없음'으로 표시할 수 있습니다.
            - **청중 (Audience):** 결과물을 소비할 대상을 지정합니다 (예: 5세 어린이, 기술 전문가).
            - **목표 (Goal):** 달성하고자 하는 구체적인 결과물을 설명합니다.
            - **톤앤매너 (Tone & Manner):** AI가 사용해야 할 어조와 스타일을 설명합니다 (예: 전문적, 유머러스).
            - **절차 (Procedure):** 목표를 달성하기 위해 따라야 할 단계나 규칙을 제시합니다.
            - **제약 조건 (Constraints):** AI가 피해야 할 사항이나 반드시 지켜야 할 규칙을 명시합니다 (예: 200단어 미만).
            - **출력 형식 (Output Format):** 결과물이 어떤 형식(예: 마크다운, JSON, 글머리 기호 목록)이어야 하는지 명시합니다.

            각 변형에 대해 제목, 구조화된 프롬프트 구성 요소들, 그리고 이러한 개선이 왜 프롬프트를 더 강력하게 만드는지에 대한 명확한 근거를 제공하세요.`;

            const responseSchema = {
                type: "ARRAY",
                items: {
                  type: "OBJECT",
                  properties: {
                    title: { type: "STRING" },
                    mission: { type: "STRING" },
                    persona: { type: "STRING" },
                    audience: { type: "STRING" },
                    goal: { type: "STRING" },
                    toneAndManner: { type: "STRING" },
                    procedure: { type: "STRING" },
                    constraints: { type: "STRING" },
                    outputFormat: { type: "STRING" },
                    reasoning: { type: "STRING" },
                  },
                  required: ["title", "mission", "persona", "audience", "goal", "toneAndManner", "procedure", "constraints", "outputFormat", "reasoning"],
                },
            };
            
            const model = genAI.getGenerativeModel({ 
                model: "gemini-2.5-flash",
                systemInstruction: { role: "model", parts: [{ text: systemInstruction }] },
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: responseSchema,
                    temperature: 0.7,
                }
            });
            
            const userPrompt = `개선할 프롬프트는 다음과 같습니다: "${originalPrompt}"`;

            const result = await model.generateContent(userPrompt);
            const response = result.response;
            const suggestions = JSON.parse(response.text());

            if (!Array.isArray(suggestions)) {
                throw new Error("API가 예상치 못한 형식을 반환했습니다.");
            }

            return suggestions;

        } catch (error) {
            console.error("Error enhancing prompt:", error);
            if (error instanceof Error) {
                throw new Error(`Gemini API에서 제안을 가져오지 못했습니다: ${error.message}`);
            }
            throw new Error("Gemini API와 통신하는 동안 알 수 없는 오류가 발생했습니다.");
        }
      };
      // --- End of geminiService.ts ---

      // --- Start of SuggestionCard.tsx ---
      const PromptSection = ({ title, content }) => {
          if (!content || content.toLowerCase() === '해당 없음' || content.toLowerCase() === 'n/a') return null;
          return (
              React.createElement('div', null, 
                  React.createElement('h4', { className: "font-semibold text-emerald-700 text-sm tracking-wider uppercase" }, title),
                  React.createElement('p', { className: "text-slate-700 mt-1 whitespace-pre-wrap font-mono text-sm leading-relaxed" }, content)
              )
          );
      };

      const SuggestionCard = ({ suggestion }) => {
        const [isCopied, setIsCopied] = useState(false);

        const handleCopy = () => {
          const { mission, persona, audience, goal, toneAndManner, procedure, constraints, outputFormat } = suggestion;
          const sections = [
              { title: "## 미션 (Mission)", content: mission },
              { title: "## 페르소나 (Persona)", content: persona },
              { title: "## 청중 (Audience)", content: audience },
              { title: "## 목표 (Goal)", content: goal },
              { title: "## 톤앤매너 (Tone & Manner)", content: toneAndManner },
              { title: "## 절차 (Procedure)", content: procedure },
              { title: "## 제약 조건 (Constraints)", content: constraints },
              { title: "## 출력 형식 (Output Format)", content: outputFormat },
          ];
          
          const fullPrompt = sections
              .filter(sec => sec.content && sec.content.toLowerCase() !== '해당 없음' && sec.content.toLowerCase() !== 'n/a')
              .map(sec => `${sec.title}\n${sec.content}`)
              .join('\n\n');

          navigator.clipboard.writeText(fullPrompt);
          setIsCopied(true);
          setTimeout(() => setIsCopied(false), 2000);
        };

        return (
          React.createElement('div', { className: "bg-white border border-emerald-200 rounded-xl p-5 transition-all duration-300 hover:border-emerald-400/50 hover:shadow-lg hover:shadow-emerald-500/10" },
            React.createElement('div', { className: "flex justify-between items-start mb-4" },
              React.createElement('h3', { className: "text-lg font-bold text-emerald-600" }, suggestion.title),
              React.createElement('button', {
                onClick: handleCopy,
                className: `p-1.5 rounded-md transition-colors duration-200 ${isCopied ? 'bg-emerald-100 text-emerald-600' : 'bg-slate-100 hover:bg-slate-200 text-slate-500 hover:text-slate-800'}`,
                'aria-label': "프롬프트 복사"
              }, isCopied ? React.createElement(CheckIcon, { className: "w-5 h-5" }) : React.createElement(ClipboardIcon, { className: "w-5 h-5" }))
            ),
            React.createElement('div', { className: "space-y-4 bg-emerald-50/80 p-4 rounded-lg mb-4 border border-emerald-200/80" },
                React.createElement(PromptSection, { title: "미션", content: suggestion.mission }),
                React.createElement(PromptSection, { title: "페르소나", content: suggestion.persona }),
                React.createElement(PromptSection, { title: "청중", content: suggestion.audience }),
                React.createElement(PromptSection, { title: "목표", content: suggestion.goal }),
                React.createElement(PromptSection, { title: "톤앤매너", content: suggestion.toneAndManner }),
                React.createElement(PromptSection, { title: "절차", content: suggestion.procedure }),
                React.createElement(PromptSection, { title: "제약 조건", content: suggestion.constraints }),
                React.createElement(PromptSection, { title: "출력 형식", content: suggestion.outputFormat })
            ),
            React.createElement('div', null,
              React.createElement('h4', { className: "font-semibold text-slate-600 text-sm" }, "개선 이유:"),
              React.createElement('p', { className: "text-slate-600 text-sm" }, suggestion.reasoning)
            )
          )
        );
      };
      // --- End of SuggestionCard.tsx ---

      // --- Start of SuggestionsDisplay.tsx ---
      const LoadingSkeleton = () => {
          return (
              React.createElement('div', { className: "space-y-6" },
                  [...Array(3)].map((_, i) => (
                      React.createElement('div', { key: i, className: "bg-white rounded-xl p-5 border border-emerald-200 animate-pulse" },
                          React.createElement('div', { className: "h-6 bg-emerald-200 rounded w-1/3 mb-4" }),
                          React.createElement('div', { className: "h-4 bg-emerald-200 rounded w-full mb-2" }),
                          React.createElement('div', { className: "h-4 bg-emerald-200 rounded w-5/6 mb-4" }),
                          React.createElement('div', { className: "h-4 bg-emerald-200 rounded w-1/2" })
                      )
                  ))
              )
          );
      };

      const SuggestionsDisplay = ({ suggestions, isLoading, error, initialPrompt, hasSearched }) => {
        const hasSuggestions = suggestions.length > 0;
        const showInitialPlaceholder = !isLoading && !error && !hasSuggestions && !hasSearched;
        const showNoResultsMessage = !isLoading && !error && !hasSuggestions && hasSearched;

        return (
          React.createElement('div', { className: "h-full flex flex-col" },
              React.createElement('h2', { className: "text-xl font-semibold text-slate-700 mb-4" }, "AI 개선 제안"),
              React.createElement('div', { className: "flex-grow overflow-y-auto pr-2 -mr-2" },
                  isLoading && React.createElement(LoadingSkeleton, null),
                  error && (
                      React.createElement('div', { className: "flex flex-col items-center justify-center h-full text-center text-red-600 bg-red-50 p-6 rounded-lg" },
                          React.createElement('p', { className: "font-semibold text-lg" }, "오류가 발생했습니다"),
                          React.createElement('p', { className: "mt-1" }, error)
                      )
                  ),
                  showInitialPlaceholder && (
                       React.createElement('div', { className: "flex flex-col items-center justify-center h-full text-center text-slate-500 bg-emerald-50/70 rounded-lg p-6" },
                           React.createElement(SparklesIcon, { className: "w-12 h-12 mb-4 text-emerald-400" }),
                           React.createElement('p', { className: "font-semibold text-slate-600" }, "개선된 프롬프트가 여기에 표시됩니다."),
                           React.createElement('p', { className: "text-sm mt-1" }, "프롬프트를 입력하고 \"프롬프트 개선\"을 클릭하여 시작하세요.")
                       )
                  ),
                  showNoResultsMessage && (
                       React.createElement('div', { className: "flex flex-col items-center justify-center h-full text-center text-slate-500 bg-emerald-50/70 rounded-lg p-6" },
                           React.createElement(QuestionMarkCircleIcon, { className: "w-12 h-12 mb-4 text-emerald-400" }),
                           React.createElement('p', { className: "font-semibold text-slate-600" }, "제안을 생성할 수 없습니다."),
                           React.createElement('p', { className: "text-sm mt-1" }, "프롬프트를 수정하거나 다른 아이디어로 다시 시도해 보세요.")
                       )
                  ),
                  !isLoading && !error && hasSuggestions && (
                      React.createElement('div', { className: "space-y-5" },
                          suggestions.map((suggestion, index) => (
                              React.createElement(SuggestionCard, { key: index, suggestion: suggestion })
                          ))
                      )
                  )
              )
          )
        );
      };
      // --- End of SuggestionsDisplay.tsx ---

      // --- Start of PromptInput.tsx ---
      const PromptInput = ({ prompt, setPrompt, onSubmit, isLoading }) => {
        return (
          React.createElement('div', { className: "h-full flex flex-col" },
            React.createElement('label', { htmlFor: "prompt-input", className: "text-xl font-semibold text-slate-700 mb-4" }, "원본 프롬프트"),
            React.createElement('textarea', {
              id: "prompt-input",
              value: prompt,
              onChange: (e) => setPrompt(e.target.value),
              placeholder: "예: 고등학생 학습 플래너 작성",
              className: "flex-grow w-full bg-emerald-50/50 border border-emerald-300 rounded-lg p-4 text-slate-800 focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-all duration-200 resize-none min-h-[250px] sm:min-h-[300px] text-base",
              rows: 10,
              disabled: isLoading
            }),
            React.createElement('button', {
              onClick: onSubmit,
              disabled: isLoading || !prompt.trim(),
              className: "mt-5 w-full inline-flex items-center justify-center px-6 py-3.5 border border-transparent text-base font-medium rounded-lg shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-emerald-500 disabled:bg-emerald-400/80 disabled:cursor-not-allowed transition-all duration-300"
            }, isLoading ? (
              React.createElement(React.Fragment, null,
                React.createElement('svg', { className: "animate-spin -ml-1 mr-3 h-5 w-5 text-white", xmlns: "http://www.w3.org/2000/svg", fill: "none", viewBox: "0 0 24 24" },
                  React.createElement('circle', { className: "opacity-25", cx: "12", cy: "12", r: "10", stroke: "currentColor", strokeWidth: "4" }),
                  React.createElement('path', { className: "opacity-75", fill: "currentColor", d: "M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z" })
                ),
                "개선 중..."
              )
            ) : (
              React.createElement(React.Fragment, null,
                React.createElement(SparklesIcon, { className: "w-5 h-5 mr-2" }),
                "프롬프트 개선"
              )
            ))
          )
        );
      };
      // --- End of PromptInput.tsx ---

      // --- Start of App.tsx ---
      const App = () => {
        const [initialPrompt, setInitialPrompt] = useState('');
        const [enhancedPrompts, setEnhancedPrompts] = useState([]);
        const [isLoading, setIsLoading] = useState(false);
        const [error, setError] = useState(null);
        const [hasSearched, setHasSearched] = useState(false);

        const handleEnhancePrompt = useCallback(async () => {
          if (!initialPrompt.trim()) {
            setError('개선할 프롬프트를 입력해주세요.');
            return;
          }
          setIsLoading(true);
          setError(null);
          setEnhancedPrompts([]);
          setHasSearched(true);

          try {
            const suggestions = await enhancePrompt(initialPrompt);
            setEnhancedPrompts(suggestions);
          } catch (err) {
            console.error(err);
            setError(err instanceof Error ? err.message : '알 수 없는 오류가 발생했습니다. 다시 시도해 주세요.');
          } finally {
            setIsLoading(false);
          }
        }, [initialPrompt]);

        return (
          React.createElement('div', { className: "min-h-screen bg-emerald-50 flex items-center justify-center p-4 sm:p-6 lg:p-8 font-sans" },
            React.createElement('div', { className: "w-full max-w-7xl bg-white rounded-3xl shadow-2xl shadow-emerald-200/50 border border-emerald-200/70 overflow-hidden flex flex-col" },
              React.createElement('header', { className: "p-6 sm:p-8 border-b border-emerald-200" },
                  React.createElement('div', { className: "flex items-center gap-4" },
                      React.createElement('div', { className: "inline-flex items-center justify-center bg-emerald-100 text-emerald-600 p-3 rounded-xl flex-shrink-0" },
                          React.createElement(SparklesIcon, { className: "w-7 h-7 sm:w-8 sm:h-8" })
                      ),
                      React.createElement('div', null,
                          React.createElement('h1', { className: "text-2xl sm:text-3xl font-bold tracking-tight text-slate-800" }, "AI 프롬프트 개선기"),
                          React.createElement('p', { className: "mt-1 text-slate-500 max-w-2xl text-sm sm:text-base" }, "단순한 아이디어를 모든 AI 모델을 위한 강력하고 상세한 프롬프트로 변환하세요.")
                      )
                  )
              ),
              React.createElement('main', { className: "grid grid-cols-1 lg:grid-cols-2 flex-grow min-h-[600px] lg:min-h-[650px]" },
                React.createElement('div', { className: "p-6 sm:p-8 lg:border-r lg:border-emerald-200" },
                   React.createElement(PromptInput, {
                      prompt: initialPrompt,
                      setPrompt: setInitialPrompt,
                      onSubmit: handleEnhancePrompt,
                      isLoading: isLoading
                   })
                ),
                React.createElement('div', { className: "p-6 sm:p-8 border-t border-emerald-200 lg:border-t-0" },
                   React.createElement(SuggestionsDisplay, {
                      suggestions: enhancedPrompts,
                      isLoading: isLoading,
                      error: error,
                      initialPrompt: initialPrompt,
                      hasSearched: hasSearched
                    })
                )
              ),
              React.createElement('footer', { className: "text-center py-4 px-6 text-slate-400 text-xs border-t border-emerald-200 bg-emerald-50/50" },
                  React.createElement('p', null, "© 2025 KH KIM. All Rights Reserved.")
              )
            )
          )
        );
      };
      // --- End of App.tsx ---
      
      // --- Start of index.tsx ---
      const rootElement = document.getElementById('root');
      if (!rootElement) {
        throw new Error("Could not find root element to mount to");
      }

      const root = ReactDOM.createRoot(rootElement);
      root.render(
        React.createElement(React.StrictMode, null,
          React.createElement(App, null)
        )
      );
      // --- End of index.tsx ---
    </script>
  </body>
</html>
